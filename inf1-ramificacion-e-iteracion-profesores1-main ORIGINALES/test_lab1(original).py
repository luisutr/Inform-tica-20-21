import pytest
import lab1 as l

@pytest.mark.basic
def test_primer_multiplo():
    assert 0 == l.primer_multiplo(1, [0])
    assert -1 == l.primer_multiplo(1, [])
    assert 2 == l.primer_multiplo(11, [1,23,44,26,15])
    assert 32 == l.primer_multiplo(7,[647, 831, 634, 208, 348, 752, 460, 664, 626, 814, 165, 738, 949, 151, 80, 508, 386, 471, 785, 16, 764, 790, 373, 317, 747, 899, 647, 712, 492, 671, 947, 627, 266, 928, 753, 625, 882, 601, 521, 785, 40, 993, 814, 752, 59, 317, 882, 611, 706, 217, 789, 644, 856, 234, 596, 834, 513, 364, 263, 108, 150, 285, 704, 804, 882, 686, 561, 93, 905, 267, 327, 66, 810, 908, 780, 522, 754, 639, 277, 575, 421, 48, 669, 311, 600, 455, 671, 589, 329, 734, 881, 958, 438, 117, 52, 138, 188, 809, 370, 182, 501, 930, 110, 592, 477, 20, 16, 311, 892, 159, 96, 874, 707, 350, 147, 360, 900, 907, 332, 916, 575, 722, 958, 194, 444, 429, 625, 928, 951, 271, 456, 812, 672, 359, 105, 878, 520, 114, 783, 824, 57, 465, 362, 572, 584, 177, 474, 438, 887, 614, 876, 371, 558, 224, 720, 209, 508, 961, 368, 513, 935, 462, 177, 489, 220, 628, 151, 95, 211, 535, 936, 465, 397, 64, 504, 802, 484, 164, 394, 516, 419, 782, 944, 117, 294, 444, 605, 437, 381, 699, 98, 13, 695, 822, 507, 738, 112, 440, 658, 16, 189, 591, 121, 337, 468, 432, 70, 564, 738, 534, 205, 894, 138, 621, 582, 637, 940, 275, 467, 618, 195, 229, 936, 423, 137, 246, 393, 49, 528, 556, 101, 550, 906, 4, 948, 491, 621, 817, 185, 998, 215, 654, 524, 842, 734, 150, 272, 732, 904, 769, 847, 86, 673, 666, 138, 817, 146, 370, 921, 651, 276, 694, 624, 391, 749, 56, 795, 659, 192, 701, 725, 144, 921, 335, 999, 356, 516, 668, 360, 656, 295, 716, 150, 503, 894, 809, 839, 264, 871, 108, 580, 565, 708, 746, 988, 34, 128, 141, 15, 313, 62, 725, 555, 936, 579, 927, 206, 416, 923, 750, 913, 501, 960, 593, 941, 967, 140, 198, 351, 863, 700, 25, 229, 815, 312, 473, 860, 150, 402, 105, 814, 364, 401, 784, 777, 141])
    
    assert 169 == l.primer_multiplo(295, [922, 972, 746, 231, 54, 746, 686, 926, 247, 914, 873, 387, 332, 369, 211, 840, 66, 637, 420, 754, 386, 984, 837, 52, 916, 197, 232, 168, 933, 487, 577, 825, 657, 507, 606, 761, 324, 617, 49, 704, 854, 981, 475, 299, 570, 90, 689, 63, 712, 848, 293, 370, 244, 57, 733, 404, 486, 749, 818, 579, 758, 586, 144, 958, 17, 866, 932, 397, 891, 918, 998, 728, 635, 619, 293, 207, 450, 784, 167, 730, 955, 461, 740, 160, 835, 132, 960, 269, 445, 62, 797, 722, 572, 755, 616, 105, 668, 464, 312, 1, 263, 252, 819, 539, 406, 32, 658, 757, 905, 871, 309, 772, 313, 452, 539, 334, 255, 143, 841, 66, 472, 524, 438, 476, 219, 930, 908, 696, 964, 42, 957, 337, 304, 118, 609, 823, 430, 762, 947, 110, 859, 302, 497, 77, 807, 195, 776, 901, 394, 400, 389, 10, 794, 460, 89, 62, 980, 775, 629, 425, 129, 662, 702, 867, 291, 31, 544, 287, 327, 0, 86, 490, 510, 52, 524, 473, 355, 73, 823, 111, 169, 301, 292, 766, 5, 499, 18, 741, 250, 25, 872, 202, 726, 953, 48, 541, 957, 938, 992, 979, 704, 580, 565, 788, 612, 318, 23, 250, 906, 263, 5, 84, 420, 335, 80, 672, 312, 879, 24, 147, 753, 775, 250, 955, 124, 403, 717, 17, 13, 847, 1, 494, 16, 118, 18, 184, 541, 824, 188, 585, 524, 203, 73, 549, 208, 622, 414, 418, 486, 868, 241, 199, 311, 913, 462, 381, 562, 267, 253, 118, 296, 800, 369, 986, 791, 412, 428, 780, 746, 529, 795, 407, 759, 949, 347, 977, 520, 686, 94, 662, 730, 452, 954, 169, 492, 715, 744, 248, 585, 716, 219, 723, 943, 93, 328, 890, 548, 165, 848, 285, 949, 770, 876, 511, 571, 95, 867, 487, 33, 855, 528, 821, 193, 16, 764, 272, 666, 814, 651, 552, 488, 967, 605, 223, 339, 954, 403, 56, 759, 279, 372, 651, 86, 127, 522, 213, 208, 982, 90, 637, 31, 395, 580, 271, 23, 868, 447, 615, 460, 922, 875, 951, 363, 66, 937, 106, 566, 358, 791, 858, 538, 150, 789, 599, 998, 649, 37, 148, 194, 756, 411, 216, 567, 558, 640, 390, 39, 752, 702, 108, 779, 913, 533, 516, 621, 396, 355, 901, 320, 599, 660, 192, 510, 54, 799, 743, 356, 484, 285, 711, 650, 510, 25, 890, 447, 227, 51, 407, 259, 491, 167, 812, 924, 404, 875, 241, 749, 562, 480, 874, 198, 268, 865, 243, 341, 371, 275, 439, 236, 119, 244, 36, 258, 803, 288, 756, 414, 848, 875, 580, 694, 745, 658, 110, 496, 987, 875, 311, 665, 316, 288, 85, 518, 896, 121, 832, 199, 308, 345, 667, 816, 59, 995, 139, 126, 570, 366, 17, 233, 590, 424, 218, 718, 705, 530, 126, 429, 662, 200, 624, 31, 163, 847, 39])

    assert -1 == l.primer_multiplo(519, [922, 972, 746, 231, 54, 746, 686, 926, 247, 914, 873, 387, 332, 369, 211, 840, 66, 637, 420, 754, 386, 984, 837, 52, 916, 197, 232, 168, 933, 487, 577, 825, 657, 507, 606, 761, 324, 617, 49, 704, 854, 981, 475, 299, 570, 90, 689, 63, 712, 848, 293, 370, 244, 57, 733, 404, 486, 749, 818, 579, 758, 586, 144, 958, 17, 866, 932, 397, 891, 918, 998, 728, 635, 619, 293, 207, 450, 784, 167, 730, 955, 461, 740, 160, 835, 132, 960, 269, 445, 62, 797, 722, 572, 755, 616, 105, 668, 464, 312, 1, 263, 252, 819, 539, 406, 32, 658, 757, 905, 871, 309, 772, 313, 452, 539, 334, 255, 143, 841, 66, 472, 524, 438, 476, 219, 930, 908, 696, 964, 42, 957, 337, 304, 118, 609, 823, 430, 762, 947, 110, 859, 302, 497, 77, 807, 195, 776, 901, 394, 400, 389, 10, 794, 460, 89, 62, 980, 775, 629, 425, 129, 662, 702, 867, 291, 31, 544, 287, 327, 86, 490, 510, 52, 524, 473, 355, 73, 823, 111, 169, 301, 292, 766, 5, 499, 18, 741, 250, 25, 872, 202, 726, 953, 48, 541, 957, 938, 992, 979, 704, 580, 565, 788, 612, 318, 23, 250, 906, 263, 5, 84, 420, 335, 80, 672, 312, 879, 24, 147, 753, 775, 250, 955, 124, 403, 717, 17, 13, 847, 1, 494, 16, 118, 18, 184, 541, 824, 188, 585, 524, 203, 73, 549, 208, 622, 414, 418, 486, 868, 241, 199, 311, 913, 462, 381, 562, 267, 253, 118, 296, 800, 369, 986, 791, 412, 428, 780, 746, 529, 795, 407, 759, 949, 347, 977, 520, 686, 94, 662, 730, 452, 954, 169, 492, 715, 744, 248, 585, 716, 219, 723, 943, 93, 328, 890, 548, 165, 848, 285, 949, 770, 876, 511, 571, 95, 867, 487, 33, 855, 528, 821, 193, 16, 764, 272, 666, 814, 651, 552, 488, 967, 605, 223, 339, 954, 403, 56, 759, 279, 372, 651, 86, 127, 522, 213, 208, 982, 90, 637, 31, 395, 580, 271, 23, 868, 447, 615, 460, 922, 875, 951, 363, 66, 937, 106, 566, 358, 791, 858, 538, 150, 789, 599, 998, 649, 37, 148, 194, 756, 411, 216, 567, 558, 640, 390, 39, 752, 702, 108, 779, 913, 533, 516, 621, 396, 355, 901, 320, 599, 660, 192, 510, 54, 799, 743, 356, 484, 285, 711, 650, 510, 25, 890, 447, 227, 51, 407, 259, 491, 167, 812, 924, 404, 875, 241, 749, 562, 480, 874, 198, 268, 865, 243, 341, 371, 275, 439, 236, 119, 244, 36, 258, 803, 288, 756, 414, 848, 875, 580, 694, 745, 658, 110, 496, 987, 875, 311, 665, 316, 288, 85, 518, 896, 121, 832, 199, 308, 345, 667, 816, 59, 995, 139, 126, 570, 366, 17, 233, 590, 424, 218, 718, 705, 530, 126, 429, 662, 200, 624, 31, 163, 847, 39])

@pytest.mark.basic
@pytest.mark.parametrize('lineas', [
    ['abc', '', 'def'],
    ['ahgdakjdhgakjshdgakjsdhgaksjdhg', 'akjshd akjsd akjsd akjsd aksjd', 'asdasd'],
    ['En las noches claras', 'resuelvo el problema de la soledad del ser.', 'Invito a la luna y con mi sombra somos tres.']
])
def test_concatena_lineas(lineas):
    assert l.concatena_lineas(lineas).split('\n') == lineas + ['']

@pytest.mark.basic
@pytest.mark.parametrize('n, esperado', [
    (10, 0.1169481777110779),
    (30, 0.7063162427192686),
    (50, 0.9703735795779884),
    (70, 0.9991595759651571),
    (90, 0.9999938483561236),
])
def test_prob_mismo_cumple(n, esperado):
    assert abs(l.prob_mismo_cumple(n) - esperado) < 1e-7

@pytest.mark.basic
@pytest.mark.parametrize('n, esperado', [
    (10, 1.5497677311665408),
    (30, 1.6121501176015975),
    (50, 1.625132733621529),
    (70, 1.630749907490019),
    (90, 1.6338844555141354),
])
def test_suma_serie(n, esperado):
    assert abs(l.suma_serie(n) - esperado) < 1e-7

@pytest.mark.hard
@pytest.mark.parametrize('L, esperado', [
    ([12314, 122, 35, 5], 5),
    ([11,11,11], None),
    ([], None),
    ([922, 971, 741, 231, 53, 741, 687, 927, 247, 914, 873, 387, 332, 369, 211, 840, 66, 637, 420, 754, 386, 984, 837, 52, 916, 197, 232, 168, 933, 487, 577, 825, 657, 507, 606, 761, 327, 617, 49, 704, 854, 981, 475, 299, 570, 689, 63, 712, 848, 293, 370, 244, 57, 733, 404, 749, 818, 579, 758, 586, 144, 958, 17, 866, 932, 397, 891, 918, 998, 728, 635, 619, 293, 207, 450, 784, 167, 730, 955, 461, 740, 160, 835, 132, 960, 269, 445, 62, 797, 722, 572, 755, 616, 105, 668, 464, 312, 1, 263, 252, 819, 539, 406, 32, 658, 757, 905, 871, 309, 772, 313, 452, 539, 334, 255, 143, 841, 66, 472, 524, 438, 476, 219, 930, 908, 696, 964, 42, 957, 337, 304, 118, 609, 823, 430, 762, 947, 110, 859, 302, 497, 77, 807, 195, 776, 901, 394, 400, 389, 10, 794, 460, 89, 62, 980, 775, 629, 425, 129, 662, 702, 867, 291, 31, 544, 287, 327, 86, 490, 510, 52, 524, 473, 355, 73, 823, 111, 169, 301, 292, 766, 5, 499, 18, 741, 250, 25, 872, 202, 726, 953, 48, 541, 957, 938, 992, 979, 704, 580, 565, 788, 612, 318, 23, 250, 906, 263, 5, 84, 420, 335, 80, 672, 312, 879, 24, 147, 753, 775, 250, 955, 124, 403, 717, 17, 13, 847, 1, 494, 16, 118, 18, 184, 541, 824, 188, 585, 524, 203, 73, 549, 208, 622, 414, 418, 868, 241, 199, 311, 913, 462, 381, 562, 267, 253, 118, 296, 800, 369, 986, 791, 412, 428, 780, 746, 529, 795, 407, 759, 949, 347, 977, 520, 686, 94, 662, 730, 452, 954, 169, 492, 715, 744, 248, 585, 716, 219, 723, 943, 93, 328, 890, 548, 165, 848, 285, 949, 770, 876, 511, 571, 95, 867, 487, 33, 855, 528, 821, 193, 16, 764, 272, 666, 814, 651, 552, 488, 967, 605, 223, 339, 954, 403, 56, 759, 279, 372, 651, 86, 127, 522, 213, 208, 982, 90, 637, 31, 395, 580, 271, 23, 868, 447, 615, 460, 922, 875, 951, 363, 66, 937, 106, 566, 358, 791, 858, 538, 150, 789, 599, 998, 649, 37, 148, 194, 756, 411, 216, 567, 558, 640, 390, 39, 752, 702, 108, 779, 913, 533, 516, 621, 396, 355, 901, 320, 599, 660, 192, 510, 54, 799, 743, 356, 484, 285, 711, 650, 510, 25, 890, 447, 227, 51, 407, 259, 491, 167, 812, 924, 404, 875, 241, 749, 562, 480, 874, 198, 268, 865, 243, 341, 371, 275, 439, 236, 119, 244, 36, 258, 803, 288, 756, 414, 848, 875, 580, 694, 745, 658, 110, 496, 987, 875, 311, 665, 316, 288, 85, 518, 896, 121, 832, 199, 308, 345, 667, 816, 59, 995, 139, 126, 570, 366, 17, 233, 590, 424, 218, 718, 705, 530, 126, 429, 662, 200, 624, 31, 163, 847, 39], 144)
])
def test_primer_feo(L, esperado):
    assert l.primer_feo(L) == esperado

@pytest.mark.hard
@pytest.mark.parametrize('n, esperado', [
    (1985, 5),
    (827391827391827319823, 4),
    (3424234234242342342342342342345346546567567, 7)
])
def test_suma_digitos(n, esperado):
    assert l.suma_digitos(n) == esperado

@pytest.mark.hard
@pytest.mark.parametrize('p, esperado', [
    ((1, 1), False),
    ((0, 0), True),
    ((-0.75, 0.1), False),
    ((-0.75, 0), True),
])
def test_en_mandelbrot(p, esperado):
    x,y = p
    assert l.en_mandelbrot(x,y) == esperado

@pytest.mark.hard
@pytest.mark.parametrize('n, esperado', [
    (2, 25),
    (4, 77),
    (5, 679),
    (6, 6788),
])
def test_primer_persistente(n, esperado):
    assert l.primer_persistente(n) == esperado

@pytest.mark.hard
def test_primer_cuadron_fuerte():
    pcf = l.primer_cuadron_fuerte()
    assert pcf < 11100
    assert pcf > 11000
    assert str(pcf).startswith('1')
    primero = int('2' + str(pcf)[1:])
    raiz = primero ** .5
    assert raiz == int(raiz)


@pytest.mark.hard
@pytest.mark.parametrize('n, esperado', [
    (12131435, True),
    (1213213, False),
    (21436231, True),
    (212121211, False),
])
def test_es_ondulante(n, esperado):
    assert l.es_ondulante(n) == esperado

@pytest.mark.basic
@pytest.mark.parametrize('p, esperado', [
    ([2,0,4],[0,8]),
    ([1,0,2,2,4,1],[0, 4, 6, 16, 5]),
    ([1,0,0,0,2,3],[0, 0, 0, 8, 15]),
])
def test_polyder(p, esperado):
    assert l.polyder(p) == esperado

@pytest.mark.basic
@pytest.mark.parametrize('p, x, esperado', [
    ([2,0,4],0,2),
    ([1,0,2,2,4,1],1,10),
    ([1,0,0,0,2,3],5,10626),
])
def test_polyval(p,x,esperado):
    assert l.polyval(p, x) == esperado

@pytest.mark.hard
@pytest.mark.parametrize('p', [
    [-4,0,4],
    [1,0,2,2,4,1],
    [1,0,0,0,2,3],
])
def test_root_bolzano(p):
    assert abs(l.polyval(p,l.root_bolzano(p))) < 1e-4

@pytest.mark.basic
@pytest.mark.parametrize('p, epsilon', [
    ([-4,0,4],1e-4),
    ([1,0,2,2,4,1],1e-4),
    ([1,0,0,0,2,3],1e-4),
])
def test_root_newton_raphson(p,epsilon):
    assert abs(l.polyval(p,l.root_newton_raphson(p,epsilon))) < epsilon




